---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# OncReg

<!-- badges: start -->
<!-- badges: end -->

Tools for working with cancer registry data.
    
## Installation
 
You can install the development version of OncReg from [GitHub](https://github.com/hongconsulting/OncReg) with:

```r
remotes::install_github("hongconsulting/OncReg")
```

## Example:

```{r}
library(OncReg)
options(width = 120)
diagnosis <- c("01/01/00", "01/01/2000", "36526", "36526", "36526")
treatment <- c("capecitabine",
                "LETROZOLE",
                "letrozole, palbociclib",
                "Letrozole,Ribociclib",
                "anastrozole, ribociclib")
progression <- c("01/01/2001", ".", "01/01/2001", "", NA)
review1 <- c("01/07/2001", "01/07/2001", "01/07/2001", "01/07/2001", "01/07/2001")
review2 <- c(NA, NA, NA, NA, "01/01/2002")
death <- c("01/01/2002", "01/01/2002", NA, NA, NA)
data0 <- data.frame("id" = 1:5, "diagnosis" = diagnosis, "treatment" = treatment, "progression" = progression, "review1" = review1, "review2" = review2, "death" = death)
print(data0)

# delimited strings
data1 <- data.frame("id" = data0$id, "treatment" = data0$treatment)
data1$treatment <- OR.delim.replace(data1$treatment, "anastrozole", "ai")
data1$treatment <- OR.delim.replace(data1$treatment, "letrozole", "ai")
data1$treatment <- OR.delim.replace(data1$treatment, "palbociclib", "cdk46i")
data1$treatment <- OR.delim.replace(data1$treatment, "ribociclib", "cdk46i")

# Microsoft Excel dates
data1$diagnosis <- OR.dmyY.to.Excel(data0$diagnosis, 20, 25)
data1$progression <- OR.dmyY.to.Excel(data0$progression, 20, 25)
data1$review1 <- OR.dmyY.to.Excel(data0$review1, 20, 25)
data1$review2 <- OR.dmyY.to.Excel(data0$review2, 20, 25)
data1$death <- OR.dmyY.to.Excel(data0$death, 20, 25)

# progression-free survival and overall survival
data1$PFS <- OR.rowmin(cbind(data1$progression, data1$death))
data1$lastreview <- OR.rowmax(cbind(data1$review1, data1$review2))
data1$PFSmonths <- OR.survoutcome(data1$diagnosis, data1$PFS, data1$lastreview)[, 1]
data1$PFSstatus <- OR.survoutcome(data1$diagnosis, data1$PFS, data1$lastreview)[, 2]
data1$OSmonths <- OR.survoutcome(data1$diagnosis, data1$death, data1$lastreview)[, 1]
data1$OSstatus <- OR.survoutcome(data1$diagnosis, data1$death, data1$lastreview)[, 2]

print(data1)
```
